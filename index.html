<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chrono Bulward v0.2.14</title>
<style>
  body { margin:0; background:#222; color:#eee; font-family:monospace; text-align:center; }
  #gameCanvas { background:#333; display:none; margin:0 auto; border:2px solid #000; }
  #menu, #settings, #help { margin-top:20px; }
  h1 { margin:20px; }
  h2 { margin-top:20px; }
  .unit-settings { border:1px solid #555; padding:10px; margin:10px auto; width:90%; max-width:400px; text-align:left; }
  input[type=range] { width:200px; }
  #ui { margin-top:10px; display:none; }
  #ui button { margin:5px; padding:8px 16px; font-size:14px; }
  #help { display:none; text-align:left; max-width:600px; margin:20px auto; padding:10px; background:#111; border:1px solid #555; }
</style>
</head>
<body>
<h1 id="title">Chrono Bulward v0.2.14</h1>

<div id="menu">
  <button onclick="startGame()">ゲーム開始</button>
  <button onclick="showSettings()">設定</button>
  <button onclick="showHelp()">説明</button> <!-- ★追加 -->
</div>

<div id="settings" style="display:none;">
  <h2>ユニット調整</h2>
  <div id="unitSliders"></div>
  <br>
  <button onclick="backToMenu()">戻る</button>
  <button onclick="applySettingsAndStart()">ゲーム開始</button>
</div>

<!-- ★説明画面 -->
<div id="help">
  <h2>ゲームのルール</h2>
  <p>自陣（下）からユニットを召喚し、敵陣（上）から進行してくる敵を防ぎます。<br>
  ユニット同士が接触すると戦闘開始、どちらかが倒れるまで動きません。</p>

  <h2>勝敗条件</h2>
  <ul>
    <li>敵ユニットが自陣に到達すると自陣HPが減少</li>
    <li>味方ユニットが敵陣に到達すると敵陣HPが減少</li>
    <li>どちらかのHPが0になると勝敗が決まります</li>
  </ul>

  <h2>キャラクター詳細</h2>
  <ul>
    <li><b>剣士</b>：HP120 / ATK10 / 近接戦闘。標準的なユニット</li>
    <li><b>弓兵</b>：HP80 / ATK8 / 射程120。遠距離攻撃でサポート</li>
    <li><b>回復役</b>：HP100 / 回復量10 / 射程80。味方を回復する</li>
    <li><b>シャーマン（敵）</b>：HP120 / ATK12 / 射程120。魔法攻撃</li>
    <li><b>ファントム（敵）</b>：HP80 / ATK10 / 射程100。高速遠隔攻撃</li>
    <li><b>ゴブリン</b>：HP60 / ATK5。雑兵</li>
    <li><b>オーク</b>：HP200 / ATK15。耐久力が高い</li>
    <li><b>ゴーレム</b>：HP400 / ATK20。非常にタフ</li>
    <li><b>ボス（オーガ/ドラゴン）</b>：高HP高攻撃力で強敵</li>
  </ul>

  <button onclick="backToMenuFromHelp()">戻る</button>
</div>

<canvas id="gameCanvas" width="400" height="600"></canvas>

<div id="ui">
  <button onclick="chooseUnit('swordsman')">剣士召喚</button>
  <button onclick="chooseUnit('archer')">弓兵召喚</button>
  <button onclick="chooseUnit('healer')">回復役召喚</button>
</div>

<script>
/* =====================
   Chrono Bulward v0.2.14
   説明画面追加
===================== */
let unitStats = {
  swordsman:{hp:120, atk:10, speed:0.25, range:25},
  archer:{hp:80, atk:8, speed:0.25, range:120},
  healer:{hp:100, atk:10, speed:0.25, range:80},
  goblin:{hp:60, atk:5, speed:0.2, range:25},
  orc:{hp:200, atk:15, speed:0.2, range:25},
  golem:{hp:400, atk:20, speed:0.1, range:25},
  shaman:{hp:120, atk:12, speed:0.25, range:120},
  phantom:{hp:80, atk:10, speed:0.5, range:100},
  ogre:{hp:600, atk:40, range:40},
  dragon:{hp:1500, atk:100, range:80}
};

/* === 設定画面処理（省略せず v0.2.13 と同じ） === */
const unitConfig = {
  swordsman:{name:"剣士", props:{hp:[50,300], atk:[5,30], speed:[0.1,1,0.05], range:[10,100]}},
  archer:{name:"弓兵", props:{hp:[40,200], atk:[5,30], speed:[0.1,1,0.05], range:[30,150]}},
  healer:{name:"回復役", props:{hp:[40,200], atk:[5,30], speed:[0.1,1,0.05], range:[30,150]}},
  goblin:{name:"ゴブリン", props:{hp:[20,200], atk:[2,20], speed:[0.1,1,0.05], range:[10,100]}},
  orc:{name:"オーク", props:{hp:[100,500], atk:[10,50], speed:[0.05,0.5,0.05], range:[10,100]}},
  golem:{name:"ゴーレム", props:{hp:[200,1000], atk:[10,50], speed:[0.05,0.3,0.05], range:[10,100]}},
  shaman:{name:"シャーマン", props:{hp:[50,250], atk:[5,30], speed:[0.1,0.5,0.05], range:[50,150]}},
  phantom:{name:"ファントム", props:{hp:[30,150], atk:[5,25], speed:[0.2,1,0.05], range:[30,120]}},
  ogre:{name:"巨大オーガ(ボス)", props:{hp:[200,2000], atk:[20,200], range:[20,200]}},
  dragon:{name:"邪竜(ボス)", props:{hp:[500,5000], atk:[50,500], range:[50,500]}}
};

const unitSlidersDiv=document.getElementById("unitSliders");
for (let key in unitConfig){
  let html=`<div class="unit-settings"><h3>${unitConfig[key].name}</h3>`;
  for (let prop in unitConfig[key].props){
    let range=unitConfig[key].props[prop];
    let min=range[0], max=range[1], step=range[2]||1;
    let val=unitStats[key][prop];
    html+=`${prop.toUpperCase()}: <input type="range" id="${key}_${prop}" min="${min}" max="${max}" step="${step}" value="${val}" oninput="updateLabel('${key}_${prop}')"><span id="${key}_${prop}_val">${val}</span><br>`;
  }
  html+="</div>";
  unitSlidersDiv.innerHTML+=html;
}
function updateLabel(id){document.getElementById(id+"_val").innerText=document.getElementById(id).value;}
function showSettings(){document.getElementById("menu").style.display="none";document.getElementById("settings").style.display="block";}
function backToMenu(){document.getElementById("settings").style.display="none";document.getElementById("menu").style.display="block";}
function applySettingsAndStart(){
  for (let key in unitStats){
    for (let prop in unitStats[key]){
      let id=`${key}_${prop}`;
      if(document.getElementById(id)){unitStats[key][prop]=parseFloat(document.getElementById(id).value);}
    }
  }
  startGame();
}
/* ★説明画面の切替 */
function showHelp(){document.getElementById("menu").style.display="none";document.getElementById("help").style.display="block";}
function backToMenuFromHelp(){document.getElementById("help").style.display="none";document.getElementById("menu").style.display="block";}

/* === ゲーム本体は v0.2.13 と同じ === */
/* Unit, Projectile, HealProjectile, HitMark, HealMark, SwingMark, inMeleeRange, inUnitRange, startGame, loop, chooseUnit */
</script>
</body>
</html>
